var TemplateEngine=function(t,e){for(var i,n=/<%([^%>]+)?%>/g,a=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,o="var r=[];\n",r=0,s=function(t,e){return o+=e?t.match(a)?t+"\n":"r.push("+t+");\n":""!=t?'r.push("'+t.replace(/"/g,'\\"')+'");\n':"",s};i=n.exec(t);)s(t.slice(r,i.index))(i[1],!0),r=i.index+i[0].length;return s(t.substr(r,t.length-r)),o+='return r.join("");',new Function(o.replace(/[\r\t\n]/g,"")).apply(e)};!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.lightbox=e(t.jQuery)}(this,function(t){function e(e){this.album=[],this.currentImageIndex=void 0,this.init(),this.options=t.extend({},this.constructor.defaults),this.option(e)}return e.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:500,fitImagesInViewport:!0,positionFromTop:50,resizeDuration:700,showImageNumberLabel:!0,wrapAround:!1,disableScrolling:!1},e.prototype.option=function(e){t.extend(this.options,e)},e.prototype.imageCountLabel=function(t,e){return this.options.albumLabel.replace(/%1/g,t).replace(/%2/g,e)},e.prototype.init=function(){this.enable(),this.build()},e.prototype.enable=function(){var e=this;t("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(i){return e.start(t(i.currentTarget)),!1})},e.prototype.build=function(){var e=this;t('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(t("body")),this.$lightbox=t("#lightbox"),this.$overlay=t("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.containerTopPadding=parseInt(this.$container.css("padding-top"),10),this.containerRightPadding=parseInt(this.$container.css("padding-right"),10),this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10),this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10),this.$overlay.hide().on("click",function(){return e.end(),!1}),this.$lightbox.hide().on("click",function(i){return"lightbox"===t(i.target).attr("id")&&e.end(),!1}),this.$outerContainer.on("click",function(i){return"lightbox"===t(i.target).attr("id")&&e.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return 0===e.currentImageIndex?e.changeImage(e.album.length-1):e.changeImage(e.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return e.currentImageIndex===e.album.length-1?e.changeImage(0):e.changeImage(e.currentImageIndex+1),!1}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return e.end(),!1})},e.prototype.start=function(e){function i(t){n.album.push({link:t.attr("href"),title:t.attr("data-title")||t.attr("title")})}var n=this,a=t(window);a.on("resize",t.proxy(this.sizeOverlay,this)),t("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var o,r=0,s=e.attr("data-lightbox");if(s){o=t(e.prop("tagName")+'[data-lightbox="'+s+'"]');for(var h=0;h<o.length;h=++h)i(t(o[h])),o[h]===e[0]&&(r=h)}else if("lightbox"===e.attr("rel"))i(e);else{o=t(e.prop("tagName")+'[rel="'+e.attr("rel")+'"]');for(var l=0;l<o.length;l=++l)i(t(o[l])),o[l]===e[0]&&(r=l)}var d=a.scrollTop()+this.options.positionFromTop,c=a.scrollLeft();this.$lightbox.css({top:d+"px",left:c+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&t("body").addClass("lb-disable-scrolling"),this.changeImage(r)},e.prototype.changeImage=function(e){var i=this;this.disableKeyboardNav();var n=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),t(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var a=new Image;a.onload=function(){var o,r,s,h,l,d,c;n.attr("src",i.album[e].link),o=t(a),n.width(a.width),n.height(a.height),i.options.fitImagesInViewport&&(c=t(window).width(),d=t(window).height(),l=c-i.containerLeftPadding-i.containerRightPadding-20,h=d-i.containerTopPadding-i.containerBottomPadding-120,i.options.maxWidth&&i.options.maxWidth<l&&(l=i.options.maxWidth),i.options.maxHeight&&i.options.maxHeight<l&&(h=i.options.maxHeight),(a.width>l||a.height>h)&&(a.width/l>a.height/h?(s=l,r=parseInt(a.height/(a.width/s),10),n.width(s),n.height(r)):(r=h,s=parseInt(a.width/(a.height/r),10),n.width(s),n.height(r)))),i.sizeContainer(n.width(),n.height())},a.src=this.album[e].link,this.currentImageIndex=e},e.prototype.sizeOverlay=function(){this.$overlay.width(t(document).width()).height(t(document).height())},e.prototype.sizeContainer=function(t,e){function i(){n.$lightbox.find(".lb-dataContainer").width(r),n.$lightbox.find(".lb-prevLink").height(s),n.$lightbox.find(".lb-nextLink").height(s),n.showImage()}var n=this,a=this.$outerContainer.outerWidth(),o=this.$outerContainer.outerHeight(),r=t+this.containerLeftPadding+this.containerRightPadding,s=e+this.containerTopPadding+this.containerBottomPadding;a!==r||o!==s?this.$outerContainer.animate({width:r,height:s},this.options.resizeDuration,"swing",function(){i()}):i()},e.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},e.prototype.updateNav=function(){var t=!1;try{document.createEvent("TouchEvent"),t=!!this.options.alwaysShowNavOnTouchDevices}catch(t){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(t&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),t&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),t&&this.$lightbox.find(".lb-next").css("opacity","1"))))},e.prototype.updateDetails=function(){var e=this;if("undefined"!=typeof this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast").find("a").on("click",function(e){void 0!==t(this).attr("target")?window.open(t(this).attr("href"),t(this).attr("target")):location.href=t(this).attr("href")}),this.album.length>1&&this.options.showImageNumberLabel){var i=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lb-number").text(i).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,function(){return e.sizeOverlay()})},e.prototype.preloadNeighboringImages=function(){if(this.album.length>this.currentImageIndex+1){var t=new Image;t.src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){var e=new Image;e.src=this.album[this.currentImageIndex-1].link}},e.prototype.enableKeyboardNav=function(){t(document).on("keyup.keyboard",t.proxy(this.keyboardAction,this))},e.prototype.disableKeyboardNav=function(){t(document).off(".keyboard")},e.prototype.keyboardAction=function(t){var e=27,i=37,n=39,a=t.keyCode,o=String.fromCharCode(a).toLowerCase();a===e||o.match(/x|o|c/)?this.end():"p"===o||a===i?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):"n"!==o&&a!==n||(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},e.prototype.end=function(){this.disableKeyboardNav(),t(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),t("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&t("body").removeClass("lb-disable-scrolling")},new e});var mountainData=mountainData||{};$(function(){function t(){n(h),a(),lightbox.option({resizeDuration:250,wrapAround:!0}),window.setTimeout(function(){o(h)},1e3)}function e(t){t.preventDefault(),r=c.indexOf($("body").attr("data-mountain")),s=t.currentTarget.classList.contains("nav-right")?r===u?0:r+1:0===r?u:r-1,i(s),n(c[s]),o(c[s])}function i(t){document.body.dataset.mountain=c[t]}function n(t){var e=mountainData[t],i=document.querySelector(".title"),n=document.querySelector(".data"),a='<h2 class="data-title"><%this.title%></h2><p class="data-elevation">elevation <b><%this.elevation%></b></p><p class="data-prominence">prominence <%this.prominence%></p><p class="data-description"><%this.description%></p>';i.innerHTML=TemplateEngine("<%this.title%>",e),n.innerHTML=TemplateEngine(a,e),n.classList.remove("transparent")}function a(){var t=document.body.offsetWidth,e=(document.body.offsetHeight,document.querySelector(".container").offsetHeight-50),i=document.querySelector(".mountains"),n=t,a=Math.round(.6*n),o=n/a;a>e&&(n=e*o,a=e),i.style.width=n+"px",i.style.height=a+"px"}function o(t){var e="6c6069e831fb567b86c7d9b75c82624f",i="https://api.flickr.com/services/rest/?&method=flickr.photos.search",n=document.createDocumentFragment(),a=document.querySelector(".photos"),o=t+"-site";console.log(o),$.getJSON(i+"&api_key="+e+"&tags="+o+"&per_page=6&tag_mode=all&sort=interestingness-asc&format=json&jsoncallback=?",function(t){}).done(function(t){$.each(t.photos.photo,function(t,e){var i="http://farm"+e.farm+".static.flickr.com/"+e.server+"/"+e.id+"_"+e.secret,a=i+"_q.jpg",o=i+"_b.jpg",r="//www.flickr.com/photos/"+e.owner+"/"+e.id,s='<img src="'+a+'" />';$("<a/>").attr("href",o).attr("rel","prefetch").attr("data-photohref",r).attr("data-lightbox","mountaindrawn").appendTo(n).append(s)}),$(a).html(n)}).fail(function(t){console.log(t)})}var r,s,h=document.body.dataset.mountain,l=document.querySelector(".nav-left"),d=document.querySelector(".nav-right"),c=Object.keys(mountainData),g=c.length,u=g-1;l.addEventListener("click",e),d.addEventListener("click",e),window.addEventListener("resize",a),$(".photos").on("click","a",function(t){t.preventDefault()}),t()});var mountainData={bugaboo:{title:"Bugaboo Spire",elevation:"10,512 ft",prominence:"1,437 ft",description:"North Ridge, a top 50 climb"},tetons:{title:"The Grand Teton",elevation:"13,776 ft",prominence:"6,529 ft",description:"Exum Ridge route"},"blanca-traverse":{title:"Little Bear - Blanca Traverse",elevation:"14,344 ft",prominence:"5,325 ft",description:"Ridge route with 6000+ feet of gain"},"glacier-peak":{title:"Glacier Peak",elevation:"10,541 ft",prominence:"7,497 ft",description:"Glissade all day"}};